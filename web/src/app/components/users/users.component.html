<div class="page--title--container">
<h3>Users</h3>
<div class="page--title--actions">

  <p-button label="Remove Users" icon="pi pi-trash" *ngIf="selectedEmployees.length" (onClick)="deleteUsers()" severity="danger"></p-button>
  <p-button label="Add User" icon="pi pi-plus" (onClick)="showDialog()" severity="primary"></p-button>
    <p-button
                    icon="pi pi-ellipsis-v"
                    [text]="true"
                    [rounded]="true"
                    severity="secondary"
                    (click)="menu.toggle($event)"
                    #menuButton>
                  </p-button>
                  <p-menu #menu [model]="tempItems" [popup]="true" appendTo="body"></p-menu>
                  
</div>
</div>
<div>
  <p-progressSpinner *ngIf="isLoading"></p-progressSpinner>
  <p-table [value]="employees" [(selection)]="selectedEmployees" [tableStyle]="{ 'min-width': '50rem' }" *ngIf="!isLoading">
    <ng-template pTemplate="header">
      <tr>
        <th style="width: 4rem"><p-tableHeaderCheckbox /></th>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Email</th>
        <th>Job Title</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-user>
      <tr>
         <td>
                <p-tableCheckbox [value]="user" />
            </td>
        <td>{{ user.first_name || "Missing" }}</td>
        <td>{{ user.last_name || "Missing" }}</td>
        <td>{{ user.email || "Missing" }}</td>
        <td>{{ user.job_title || "Missing"}}</td>
        <td>
          <div class="flex gap-1" style="display: flex;gap:5px">
            <!-- <p-button label="Edit" icon="pi pi-pencil" severity="info" [outlined]="true"></p-button>
            <p-button label="Delete" icon="pi pi-trash" severity="danger" [outlined]="true"></p-button> -->
            <div class="card flex justify-center">
<div class="card flex justify-center">
        <p-button 
          type="button" 
          icon="pi pi-ellipsis-v" 
          styleClass="p-button-text p-button-rounded"
          (click)="menu.toggle($event)">
        </p-button>
        
        <p-menu #menu [popup]="true" [model]="getMenuItems(user)" appendTo="body"></p-menu>
</div>

</div>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <p-paginator
    *ngIf="!isLoading"
    [rows]="size"
    [totalRecords]="total"
    [first]="page"
    [rowsPerPageOptions]="[5, 10, 20]"
    (onPageChange)="onPageChange($event)">
  </p-paginator>
</div>

<app-add-user
  [visible]="addUserVisible"
  [userData]="{ isEdit: isEdit, userForm: userForm }"
  (closeModal)="onAddUserClose($event)">
</app-add-user>

<p-toast></p-toast>
