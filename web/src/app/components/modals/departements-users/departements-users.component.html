<p-dialog [header]="isEdit ?isSetManager?'Edit Manager': 'Edit Departement' : 'Add Departement'"
  class="flex gap-2 flex-column" [modal]="true" [(visible)]="visible"
  [style]="{ width: '25rem',display:'flex',flexDirection:'column' }" (onHide)="closeModal(false)">
  <div *ngIf="!isSetManager; else SetManagerTemplate">

    <form [formGroup]="newDep" class="flex flex-column  gap-3 my-3">

      <label for="username" class="font-semibold w-6rem">Departement Name</label>
      <input pInputText class="flex-auto" formControlName="departmentName" autocomplete="off" />

    </form>

    <div class="flex align-items-center gap-3">
      Edit Members <p-inputSwitch [(ngModel)]="isEditChecked" />Add Members
    </div>
<div class="flex flex-column gap-3">


    <div *ngIf="!isEditChecked;else addMembers" class="my-5">
      <div *ngIf="membersLength  ;else noMemberTemplate">
<div class="flex flex-column gap-3">

        <div *ngFor="let employee of members; let i = index">
          <div class="flex align-items-center justify-content-between">
            <div class="flex align-items-center gap-2">
            <p-avatar [label]="getInitials(employee.firstName, employee.lastName)" shape="circle"
              [style]="{'background-color': getAvatarColor(employee.id||0), 'color': 'white'}">
            </p-avatar>
            <span>{{employee.firstName}} {{employee.lastName}}</span>
            </div>
            <p-button severity="secondary" (onClick)="removeMember(employee.id)">
              remove
            </p-button>
          </div>
          </div>
        </div>

      </div>
      <ng-template #noMemberTemplate>
        <span>NO MEMBERS UNFORTUNATLY</span>
      </ng-template>
</div>
    </div>
    <div class="my-5">

      <ng-template #addMembers>
        <div class="flex flex-column gap-3">
        <div *ngFor="let employee of employees; let i = index">
          <div class="flex align-items-center justify-content-between">
            <div class="flex align-items-center gap-2">
            <p-avatar [label]="getInitials(employee.firstName, employee.lastName)" shape="circle"
              [style]="{'background-color': getAvatarColor(employee.id||0), 'color': 'white'}">
            </p-avatar>
            <span>{{employee['firstName']}} {{employee['lastName']}}</span>
            </div>
            <p-button label="Add User" severity="secondary" (onClick)="addMember(employee.id)" />
          </div>
        </div>
      </div>
    </ng-template>
    </div>
    <div class="flex justify-content-end gap-2">
      <p-button label="Cancel" severity="secondary" (onClick)="closeModal(false)" />
      <p-button label="Save" (onClick)="editDepartment()" />
    </div>
  </div>
  <ng-template #SetManagerTemplate>
    <span>You can select only the employee that belongs to this department</span>
    <div *ngIf="members.length;else noMembersTemplate" class="mt-5">
      <!-- <div *ngIf="selectedDepartement;else templateName">

    </div> -->
      <div *ngIf="selectedDepartement.manager;else noManager" class="flex align-items-center justify-content-between">

        <span>{{selectedDepartement.manager['firstName']}} {{selectedDepartement.manager['lastName']}}</span>
        <p-button (click)="removeManager()">Remove</p-button>

      </div>
      <ng-template #noManager>

        <div *ngFor="let employee of members" class="flex align-items-center justify-content-between">
          <span>{{employee.firstName}} {{employee.lastName}}</span>
          <p-button (click)="setManager(employee.id)">Set as manager</p-button>
        </div>
      </ng-template>
    </div>
    <ng-template #noMembersTemplate>
      <span></span>
      <p-messages [value]="[
{ severity: 'warn', summary: 'Please add users to set a manager' }
]" [closable]="false" />

    </ng-template>
  </ng-template>
</p-dialog>
